ğŸš€ ä½œä¸šå¼€å§‹äº: Wed Jun 25 07:09:21 UTC 2025
ğŸ“Œ èŠ‚ç‚¹: c03
ğŸ”§ ä½¿ç”¨ CPU æ ¸æ•°: 8
Using device: cpu
Loading data to collect Chinese vocabulary for GPT-2...
Found 20 unique Chinese words/characters to add to GPT-2 tokenizer.
Loading and configuring GPT-2...
GPT-2 tokenizer vocabulary extended. New size: 50277
GPT-2 model embedding layer resized.
Loading CPM...

--- Starting 4 rounds of interaction (Verbose Mode) ---


========================= æ¸¸æˆå›åˆ 1 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: GPT-2
    ğŸ‘‚  Listener: CPM

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'airplane'
    Speakerç”Ÿæˆçš„æè¿°: 'Airplane is a type of airplane which can be flown from the ground or from the air in all weather conditions.'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['è€å¸ˆ', 'å­¦æ ¡', 'æ©˜å­', 'é£æœº']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 3: 'é£æœº')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'è€å¸ˆ': 0.8281
        - é€‰é¡¹ 'å­¦æ ¡': 0.8298
        - é€‰é¡¹ 'æ©˜å­': 0.8536
        - é€‰é¡¹ 'é£æœº': 0.8597
    Listenerçš„é€‰æ‹©: ç´¢å¼• 3 -> 'é£æœº'
    âœ… ç»“è®º: çŒœæµ‹æ­£ç¡®ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.3695
        - å¥–æƒ©ç³»æ•°: 0.90 (å¥–åŠ±)
        -  => æœ€ç»ˆ Listener Loss = 1.2325
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘'Airplane is a type o...'å’Œ'é£æœº'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.1058
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - (çŒœæµ‹æ­£ç¡®ï¼Œæ— éœ€è®¡ç®—æ­¤é¡¹æŸå¤±)
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©'Airplane is a type o...'ä¸'é£æœº'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 1.3770
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.2325 + (0.5 * -0.1058) + (0.5 * 0.0000) + (0.5 * 1.3770)
                   = 1.2325 + -0.0529 + 0.0000 + 0.6885
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 1.8681

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= æ¸¸æˆå›åˆ 2 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: CPM
    ğŸ‘‚  Listener: GPT-2

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'é£æœº'
    Speakerç”Ÿæˆçš„æè¿°: 'ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:é£æœºæè¿°:ç‰©ä½“:ç‰©ä½“æ˜¯é£æœº,ä½†æ˜¯ç‰©ä½“çš„ç»„æˆæ˜¯ç‰©ä½“çš„ç»„æˆ,æ¯”å¦‚ç‰©'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['teacher', 'school', 'airplane', 'orange']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 2: 'airplane')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'teacher': 0.1445
        - é€‰é¡¹ 'school': 0.0841
        - é€‰é¡¹ 'airplane': 0.1018
        - é€‰é¡¹ 'orange': 0.1629
    Listenerçš„é€‰æ‹©: ç´¢å¼• 3 -> 'orange'
    âŒ ç»“è®º: çŒœæµ‹é”™è¯¯ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.4083
        - å¥–æƒ©ç³»æ•°: 1.10 (æƒ©ç½š)
        -  => æœ€ç»ˆ Listener Loss = 1.5491
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘'ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:é£æœºæè¿°:ç‰©ä½“:ç‰©...'å’Œ'airplane'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.1135
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - ç›®æ ‡: æ¨è¿œ'ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:é£æœºæè¿°:ç‰©ä½“:ç‰©...'å’Œè¢«é”™é€‰çš„'orange'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Anti-Alignment Loss = 0.0845
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©'ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:é£æœºæè¿°:ç‰©ä½“:ç‰©...'ä¸'airplane'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 0.9279
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.5491 + (0.5 * -0.1135) + (0.5 * 0.0845) + (0.5 * 0.9279)
                   = 1.5491 + -0.0568 + 0.0423 + 0.4640
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 1.9986

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= æ¸¸æˆå›åˆ 3 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: GPT-2
    ğŸ‘‚  Listener: CPM

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'cat'
    Speakerç”Ÿæˆçš„æè¿°: ''A cat is a large mammal that typically lives in the wild on the outskirts of human civilization. They are generally solitary, and are often'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['ç‹—', 'ä¹¦æœ¬', 'æ²™å‘', 'çŒ«']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 3: 'çŒ«')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'ç‹—': 0.6144
        - é€‰é¡¹ 'ä¹¦æœ¬': 0.8110
        - é€‰é¡¹ 'æ²™å‘': 0.7780
        - é€‰é¡¹ 'çŒ«': 0.8688
    Listenerçš„é€‰æ‹©: ç´¢å¼• 3 -> 'çŒ«'
    âœ… ç»“è®º: çŒœæµ‹æ­£ç¡®ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.2899
        - å¥–æƒ©ç³»æ•°: 0.90 (å¥–åŠ±)
        -  => æœ€ç»ˆ Listener Loss = 1.1609
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘''A cat is a large ma...'å’Œ'çŒ«'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.0718
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - (çŒœæµ‹æ­£ç¡®ï¼Œæ— éœ€è®¡ç®—æ­¤é¡¹æŸå¤±)
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©''A cat is a large ma...'ä¸'çŒ«'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 1.2838
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.1609 + (0.5 * -0.0718) + (0.5 * 0.0000) + (0.5 * 1.2838)
                   = 1.1609 + -0.0359 + 0.0000 + 0.6419
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 1.7669

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= æ¸¸æˆå›åˆ 4 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: CPM
    ğŸ‘‚  Listener: GPT-2

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'çŒ«'
    Speakerç”Ÿæˆçš„æè¿°: 'ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:çŒ«æè¿°:è¿™é‡Œç”¨çŒ«æŒ‡ä»£ä¸€ä¸ªçŠ¶æ€,â€œâ€æ˜¯ä¸€ä¸ªçŠ¶æ€,â€œâ€æ˜¯'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['book', 'cat', 'dog', 'sofa']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 1: 'cat')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'book': 0.2940
        - é€‰é¡¹ 'cat': 0.3407
        - é€‰é¡¹ 'dog': 0.2604
        - é€‰é¡¹ 'sofa': 0.2553
    Listenerçš„é€‰æ‹©: ç´¢å¼• 1 -> 'cat'
    âœ… ç»“è®º: çŒœæµ‹æ­£ç¡®ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.3337
        - å¥–æƒ©ç³»æ•°: 0.90 (å¥–åŠ±)
        -  => æœ€ç»ˆ Listener Loss = 1.2004
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘'ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:çŒ«æè¿°:è¿™é‡Œç”¨çŒ«æŒ‡...'å’Œ'cat'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.1302
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - (çŒœæµ‹æ­£ç¡®ï¼Œæ— éœ€è®¡ç®—æ­¤é¡¹æŸå¤±)
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©'ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:çŒ«æè¿°:è¿™é‡Œç”¨çŒ«æŒ‡...'ä¸'cat'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 0.9458
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.2004 + (0.5 * -0.1302) + (0.5 * 0.0000) + (0.5 * 0.9458)
                   = 1.2004 + -0.0651 + 0.0000 + 0.4729
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 1.6082

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= è®­ç»ƒç»“æŸ =========================
âœ… å‡†ç¡®ç‡: 75.00% | å¹³å‡æŸå¤±: 1.8104
ğŸ“„ è¯¦ç»†ç»“æœå·²ä¿å­˜è‡³: /ubsnhome/23063003r/refgame_project/output/final_training_run_results_verbose.json
âœ… ä½œä¸šç»“æŸäº: Wed Jun 25 07:10:52 UTC 2025
