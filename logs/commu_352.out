ğŸš€ ä½œä¸šå¼€å§‹äº: Wed Jun 25 07:25:56 UTC 2025
ğŸ“Œ èŠ‚ç‚¹: c03
ğŸ”§ ä½¿ç”¨ CPU æ ¸æ•°: 8
Using device: cpu
Loading data to collect Chinese vocabulary for GPT-2...
Found 20 unique Chinese words/characters to add to GPT-2 tokenizer.
Loading and configuring GPT-2...
GPT-2 tokenizer vocabulary extended. New size: 50277
GPT-2 model embedding layer resized.
Loading CPM...

--- Starting 4 rounds of interaction (Verbose Mode) ---


========================= æ¸¸æˆå›åˆ 1 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: GPT-2
    ğŸ‘‚  Listener: CPM

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'airplane'
    Speakerç”Ÿæˆçš„æè¿°: ''A machine that flies through the air with the help of a pilot.'

The first airplane was invented by Dutch scientist Jan Van Leeuwen'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['è€å¸ˆ', 'æ©˜å­', 'å­¦æ ¡', 'é£æœº']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 3: 'é£æœº')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'è€å¸ˆ': 0.8136
        - é€‰é¡¹ 'æ©˜å­': 0.8503
        - é€‰é¡¹ 'å­¦æ ¡': 0.8311
        - é€‰é¡¹ 'é£æœº': 0.5609
    Listenerçš„é€‰æ‹©: ç´¢å¼• 1 -> 'æ©˜å­'
    âŒ ç»“è®º: çŒœæµ‹é”™è¯¯ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.5960
        - å¥–æƒ©ç³»æ•°: 1.10 (æƒ©ç½š)
        -  => æœ€ç»ˆ Listener Loss = 1.7556
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘''A machine that flie...'å’Œ'é£æœº'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.0456
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - ç›®æ ‡: æ¨è¿œ''A machine that flie...'å’Œè¢«é”™é€‰çš„'æ©˜å­'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Anti-Alignment Loss = 0.0413
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©''A machine that flie...'ä¸'é£æœº'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 1.2805
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.7556 + (0.5 * -0.0456) + (0.5 * 0.0413) + (0.5 * 1.2805)
                   = 1.7556 + -0.0228 + 0.0207 + 0.6403
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 2.3937

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= æ¸¸æˆå›åˆ 2 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: CPM
    ğŸ‘‚  Listener: GPT-2

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'é£æœº'
    Speakerç”Ÿæˆçš„æè¿°: 'æœ¬ä¹¦é…æœ‰ä¸€å¼ å…‰ç›˜,åŒ…æ‹¬æ•™ç¨‹å’Œå¤§é‡çš„è§†é¢‘,ç”¨äºè¯»è€…çš„ç»ƒä¹ ,åŒæ—¶ä¹Ÿé€‚åˆæœ‰ä¸€å®š'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['airplane', 'teacher', 'school', 'orange']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 0: 'airplane')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'airplane': 0.1527
        - é€‰é¡¹ 'teacher': 0.1035
        - é€‰é¡¹ 'school': 0.1409
        - é€‰é¡¹ 'orange': 0.2197
    Listenerçš„é€‰æ‹©: ç´¢å¼• 3 -> 'orange'
    âŒ ç»“è®º: çŒœæµ‹é”™è¯¯ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.3887
        - å¥–æƒ©ç³»æ•°: 1.10 (æƒ©ç½š)
        -  => æœ€ç»ˆ Listener Loss = 1.5276
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘'æœ¬ä¹¦é…æœ‰ä¸€å¼ å…‰ç›˜,åŒ…æ‹¬æ•™ç¨‹å’Œå¤§é‡çš„è§†é¢‘,...'å’Œ'airplane'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.0637
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - ç›®æ ‡: æ¨è¿œ'æœ¬ä¹¦é…æœ‰ä¸€å¼ å…‰ç›˜,åŒ…æ‹¬æ•™ç¨‹å’Œå¤§é‡çš„è§†é¢‘,...'å’Œè¢«é”™é€‰çš„'orange'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Anti-Alignment Loss = 0.0690
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©'æœ¬ä¹¦é…æœ‰ä¸€å¼ å…‰ç›˜,åŒ…æ‹¬æ•™ç¨‹å’Œå¤§é‡çš„è§†é¢‘,...'ä¸'airplane'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 1.1636
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.5276 + (0.5 * -0.0637) + (0.5 * 0.0690) + (0.5 * 1.1636)
                   = 1.5276 + -0.0319 + 0.0345 + 0.5818
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 2.1120

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= æ¸¸æˆå›åˆ 3 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: GPT-2
    ğŸ‘‚  Listener: CPM

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'cat'
    Speakerç”Ÿæˆçš„æè¿°: 'A cat is a mammal that has a short back with a long face.

The human form of the cat is the domestic cat.'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['æ²™å‘', 'ä¹¦æœ¬', 'ç‹—', 'çŒ«']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 3: 'çŒ«')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'æ²™å‘': 0.8712
        - é€‰é¡¹ 'ä¹¦æœ¬': 0.8135
        - é€‰é¡¹ 'ç‹—': 0.8381
        - é€‰é¡¹ 'çŒ«': 0.8539
    Listenerçš„é€‰æ‹©: ç´¢å¼• 0 -> 'æ²™å‘'
    âŒ ç»“è®º: çŒœæµ‹é”™è¯¯ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.3768
        - å¥–æƒ©ç³»æ•°: 1.10 (æƒ©ç½š)
        -  => æœ€ç»ˆ Listener Loss = 1.5145
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘'A cat is a mammal th...'å’Œ'çŒ«'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.0585
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - ç›®æ ‡: æ¨è¿œ'A cat is a mammal th...'å’Œè¢«é”™é€‰çš„'æ²™å‘'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Anti-Alignment Loss = 0.0048
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©'A cat is a mammal th...'ä¸'çŒ«'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 1.1967
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.5145 + (0.5 * -0.0585) + (0.5 * 0.0048) + (0.5 * 1.1967)
                   = 1.5145 + -0.0292 + 0.0024 + 0.5983
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 2.0860

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= æ¸¸æˆå›åˆ 4 =========================

â–¶ï¸  é˜¶æ®µ 1: è§’è‰²åˆ†é…ä¸ä»»åŠ¡è®¾ç½®
    ğŸ—£ï¸  Speaker: CPM
    ğŸ‘‚  Listener: GPT-2

â–¶ï¸  é˜¶æ®µ 2: Speaker ç”Ÿæˆæè¿°
    Speakeræ¥æ”¶åˆ°çš„æ¦‚å¿µ: 'çŒ«'
    Speakerç”Ÿæˆçš„æè¿°: 'å°æ²³å¼¯å¼¯,'

â–¶ï¸  é˜¶æ®µ 3: Listener ç†è§£ä¸çŒœæµ‹
    Listeneræ¥æ”¶åˆ°çš„é€‰é¡¹: ['dog', 'sofa', 'cat', 'book']
    (æœ¬è½®æ­£ç¡®ç­”æ¡ˆæ˜¯ç´¢å¼• 2: 'cat')
    è®¡ç®—å‡ºçš„ç›¸ä¼¼åº¦:
        - é€‰é¡¹ 'dog': 0.2328
        - é€‰é¡¹ 'sofa': 0.2852
        - é€‰é¡¹ 'cat': 0.3157
        - é€‰é¡¹ 'book': 0.2316
    Listenerçš„é€‰æ‹©: ç´¢å¼• 2 -> 'cat'
    âœ… ç»“è®º: çŒœæµ‹æ­£ç¡®ï¼

â–¶ï¸  é˜¶æ®µ 4: å¤åˆæŸå¤±è®¡ç®— (è¯¦ç»†åˆ†è§£)
    [A] Listener Loss:
        - åŸºç¡€äº¤å‰ç†µæŸå¤±: 1.3376
        - å¥–æƒ©ç³»æ•°: 0.90 (å¥–åŠ±)
        -  => æœ€ç»ˆ Listener Loss = 1.2038
    [B] Alignment Loss (å¸å¼•åŠ›):
        - ç›®æ ‡: æ‹‰è¿‘'å°æ²³å¼¯å¼¯,...'å’Œ'cat'çš„è¯­ä¹‰è·ç¦»
        -  => è®¡ç®—å‡ºçš„ Alignment Loss = -0.0312
    [C] Anti-Alignment Loss (æ’æ–¥åŠ›):
        - (çŒœæµ‹æ­£ç¡®ï¼Œæ— éœ€è®¡ç®—æ­¤é¡¹æŸå¤±)
    [D] Contrastive Loss (åŒºåˆ†åŠ›):
        - ç›®æ ‡: è®©'å°æ²³å¼¯å¼¯,...'ä¸'cat'çš„ç›¸ä¼¼åº¦è¿œé«˜äºå…¶ä»–æ‰€æœ‰é€‰é¡¹
        -  => è®¡ç®—å‡ºçš„ Contrastive Loss = 1.4311
    [E] æ€»æŸå¤±è®¡ç®—:
        ----------------------------------------
        Total Loss = Listener_Loss + (W_align * Align_L) + (W_anti * Anti_L) + (W_contrast * Contrast_L)
                   = 1.2038 + (0.5 * -0.0312) + (0.5 * 0.0000) + (0.5 * 1.4311)
                   = 1.2038 + -0.0156 + 0.0000 + 0.7155
        ----------------------------------------
        ==> ğŸ’¸ æœ€ç»ˆæ€»æŸå¤± (Final Total Loss): 1.9038

â–¶ï¸  é˜¶æ®µ 5: æ¨¡å‹ååŒæ›´æ–°
    æ‰§è¡Œ total_loss.backward() è®¡ç®—ä¸¤ä¸ªAgentæ‰€æœ‰ç›¸å…³å‚æ•°çš„æ¢¯åº¦...
    æ‰§è¡Œ speaker.optimizer.step() æ›´æ–° CPM çš„æƒé‡...
    æ‰§è¡Œ listener.optimizer.step() æ›´æ–° GPT-2 çš„æƒé‡...
    âœ… æ›´æ–°å®Œæˆ!


========================= è®­ç»ƒç»“æŸ =========================
âœ… å‡†ç¡®ç‡: 25.00% | å¹³å‡æŸå¤±: 2.1239
ğŸ“„ è¯¦ç»†ç»“æœå·²ä¿å­˜è‡³: /ubsnhome/23063003r/refgame_project/output/final_training_run_results_verbose.json
âœ… ä½œä¸šç»“æŸäº: Wed Jun 25 07:27:32 UTC 2025
